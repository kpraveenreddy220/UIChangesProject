<!DOCTYPE HTML>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="/html/sdk/assets/css/styles.css">
    <link  rel="stylesheet" href="/html/sdk/components/bootstrap-3.3.7/css/bootstrap.min.css">

    <script type="text/javascript" src="/html/sdk/components/jquery-2.2.4/jquery.js"></script>
    <script type="text/javascript" src="/html/sdk/components/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/html/sdk/components/mustache-2.3.0/mustache.min.js"></script>

    <script type="text/javascript" src="/html/sdk/assets/js/app.js"></script>
    <script> 
    $(document).ready(function() {
    	$("#resultContainer").hide(250);
     $("#resourceSigner").submit(function(e) {
         var url = "/cgi-bin/sdk/file/signature"; // the script where you handle the form input.
         $.ajax({
                type: "GET",
                url: url,
                data: $("#resourceSigner").serialize(), // serializes the form's elements.
                success: function(response){
                	$("#formContainer").hide(250);
						$("#resultContainer").show(250);
					if(response.getElementsByTagName('statusCode')[0].textContent == '0'){
						$("#resultContainer").css("background-color", "#cae9ad");
						$("#result")[0].innerText = "MAC Code:";
						$("#result")[0].innerText  += response.getElementsByTagName('mac')[0].textContent;
					} else {
						$("#resultContainer").css("background-color", "#e3a8a8");
						$("#result")[0].innerText  += response.getElementsByTagName('error')[0].textContent;
					}
                },
              });

         e.preventDefault(); // avoid to execute the actual submit of the form.
     });
     $('#goBack').click(function(){
    	 $("#formContainer").show(250);
    	 $("#resultContainer").hide(250);
    	 $("#result")[0].innerText = '';
     });
    });
    </script>
</head>

<body>
   <nav style="background-image: url('/html/sdk/assets/images/bar.png'); background-size: 100%; padding-left: 15px;">
    <img src='/html/sdk/assets/images/logo.png' style="vertical-align: baseline;">
    <div style="display: inline-block; font-family: sans-serif; height: 36px;">
        <a href='/html/sdk' style="font-size: 26px; font-weight: bold; color: white;">Luxe SDK - Chapter 1 - HTTP API</a>
        <a href="javascript:openAboutWindow();" style="font-size: 10px; color: white;">SDK version</a>
        <a href="javascript:openAboutFullWindow();" style="font-size: 10px; color: white;">Full version</a>
    </div>
</nav>

<div class="container-fluid">
    <div id="sidebar-menu" class="col-md-3 hidden-xs hidden-sm">
        <ul class="main-menu nav nav-stacked affix">
        </ul>
    </div>
    <div id="static-content" class="col-md-9">
    	<h1 id="par-1">ResourceSigner</h1>
    		This function calculates the signature (MAC) for a provided file (binary or text).  This does <b><i>not</i></b> use the
			internally injected secret MAC key.  The user <b><i>must</i></b> provide the key to use this functions.
			<p>
			The value returns is a HEX ASCII MAC value (signature) as this is the format expected by the
			<a href='/html/sdk/section_4/chapter_3.html'>secure resource loading</a> utilities.
			<hr>
		 <h2 id="sub-par-5-1">POST method with Content-Type: Multipart/form-data</h2>
			This is a sample POST form where the information to be POST'd is from a file using this web based form.
			Please use the [Browse] button to select a file (binary or ASCII text) to send to this utility for MAC'ing.
			<p>
			<div id="formContainer" class="container">
				<form id="resourceSigner">
					<div class="col-md-6 form-line">
			  			<div class="form-group">
			  				<label for="key">MAC Key</label>
					    	<input type="text" class="form-control" name="key" value="1010101010101010" required>
				  		</div>
				  		<div class="form-group">
					    	<label for="file">Please select a resource to sign-</label>
					    	<input type="file" class="form-control" name="file" required>
					  	</div>	
					  	<div class="form-group">
					    	<label for="resourceType">Set the resource type</label>
					    	<select class="form-control" name="resourceType" required>
					        	<option value="1">Background</option>
							    <option value="7">Keyboard</option>
							    <option value="129">PAN or CVV</option>
					      	</select>
			  			</div>
			  			<input type="submit" class="btn" value="Submit Request" />
			  		</div>
				</form>
			</div>
			<div id="resultContainer" class="container">
			  <input type="button" class="btn btn-link" id="goBack" value="Resouce Signer"> 
				<h3>Result </h3>
				<p id="result"></p>				
			</div>
			<hr>
		<font size='-2'>This page is installed in /home/sdk/html/resourcesigner/index.html</font>
    </div>
</div>
</body>
</html>

